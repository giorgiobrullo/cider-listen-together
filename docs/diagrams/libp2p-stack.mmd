flowchart TB
    subgraph Application["Application Layer"]
        session["Session (uniffi::Object)"]
        network["NetworkManager (tokio task)"]
    end

    subgraph Swarm["Swarm CiderBehaviour"]
        subgraph row1[" "]
            gossipsub["gossipsub::Behaviour<br/>Pub/sub messaging"]
            relay["relay::client::Behaviour<br/>Circuit Relay v2"]
            dcutr["dcutr::Behaviour<br/>Hole punching"]
        end
        subgraph row2[" "]
            mdns["mdns::Behaviour<br/>LAN discovery"]
            identify["identify::Behaviour<br/>Protocol negotiation"]
            ping["ping::Behaviour<br/>Keep-alive"]
        end
    end

    subgraph Transport["Transport Layer"]
        tcp["TCP + Noise + Yamux"]
        quic["QUIC (TLS 1.3)"]
    end

    session --> network
    network --> Swarm
    row1 ~~~ row2
    Swarm --> tcp & quic
