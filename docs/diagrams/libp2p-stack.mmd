flowchart TB
    subgraph Application["Application Layer"]
        session["Session (uniffi::Object)"]
        network["NetworkManager (tokio task)"]
    end

    subgraph Swarm["libp2p::Swarm&lt;CiderBehaviour&gt;"]
        subgraph Behaviours["#[derive(NetworkBehaviour)]"]
            gossipsub["gossipsub::Behaviour<br/>╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌<br/>Pub/sub room messaging<br/>Topic: cider-room-{code}"]
            relay["relay::client::Behaviour<br/>╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌<br/>Circuit Relay v2<br/>NAT traversal"]
            dcutr["dcutr::Behaviour<br/>╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌<br/>Direct Connection Upgrade<br/>Hole punching after relay"]
            mdns["mdns::tokio::Behaviour<br/>╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌<br/>LAN discovery<br/>Multicast 224.0.0.251:5353"]
            identify["identify::Behaviour<br/>╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌<br/>Protocol negotiation<br/>/cider-together/1.0.0"]
            ping["ping::Behaviour<br/>╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌<br/>Keep-alive<br/>Interval: 15s"]
        end
    end

    subgraph Transport["Transport Layer"]
        tcp["TCP<br/>╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌<br/>+ Noise (encryption)<br/>+ Yamux (multiplexing)"]
        quic["QUIC<br/>╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌<br/>Built-in TLS 1.3<br/>UDP-based, 0-RTT"]
    end

    session --> network
    network --> Swarm
    Behaviours --> tcp & quic
